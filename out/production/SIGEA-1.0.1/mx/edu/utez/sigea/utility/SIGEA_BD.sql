-- MySQL Script generated by MySQL Workbench
-- Mon Jul  8 20:14:27 2019
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema SIGEA
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema SIGEA
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `SIGEA` DEFAULT CHARACTER SET utf8 ;
USE `SIGEA` ;

-- -----------------------------------------------------
-- Table `SIGEA`.`rol`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`rol` (
  `id_rol` INT NOT NULL AUTO_INCREMENT,
  `Nombre_rol` VARCHAR(45) NULL,
  PRIMARY KEY (`id_rol`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`usuario`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`usuario` (
  `id_User` INT NOT NULL AUTO_INCREMENT,
  `id_usuario` VARCHAR(45) NOT NULL,
  `id_contrasena` VARCHAR(45) NOT NULL,
  `rol_id_rol` INT NOT NULL,
  PRIMARY KEY (`id_User`),
  INDEX `fk_usuario_rol1_idx` (`rol_id_rol` ASC) VISIBLE,
  CONSTRAINT `fk_usuario_rol1`
    FOREIGN KEY (`rol_id_rol`)
    REFERENCES `SIGEA`.`rol` (`id_rol`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`docente`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`docente` (
  `id_Docente` INT NOT NULL AUTO_INCREMENT,
  `Nombre_docente` VARCHAR(45) NOT NULL,
  `PrimerApellido_Docente` VARCHAR(45) NOT NULL,
  `SegundoApellido_Docente` VARCHAR(45) NOT NULL,
  `usuario_id_User` INT NOT NULL,
  PRIMARY KEY (`id_Docente`),
  INDEX `fk_docente_usuario1_idx` (`usuario_id_User` ASC) VISIBLE,
  CONSTRAINT `fk_docente_usuario1`
    FOREIGN KEY (`usuario_id_User`)
    REFERENCES `SIGEA`.`usuario` (`id_User`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`Carrera`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`Carrera` (
  `id_carrera` INT NOT NULL,
  `Nombre_Carrera` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id_carrera`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`division`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`division` (
  `id_division` VARCHAR(45) NOT NULL,
  `nombre_division` VARCHAR(45) NULL,
  `carrera_id_carrera` INT NOT NULL,
  PRIMARY KEY (`id_division`),
  INDEX `fk_division_Carrera1_idx` (`carrera_id_carrera` ASC) VISIBLE,
  CONSTRAINT `fk_division_Carrera1`
    FOREIGN KEY (`carrera_id_carrera`)
    REFERENCES `SIGEA`.`Carrera` (`id_carrera`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`estudiante`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`estudiante` (
  `id_estudiante` INT NOT NULL,
  `Nombre_estudiante` VARCHAR(45) NOT NULL,
  `PrimerApellido_estudiante` VARCHAR(45) NOT NULL,
  `SegundoApellido_estudiante` VARCHAR(45) NOT NULL,
  `division_id_division` VARCHAR(45) NOT NULL,
  `usuario_id_User` INT NOT NULL,
  `Carrera_idCarrera` INT NOT NULL,
  PRIMARY KEY (`id_estudiante`),
  INDEX `fk_estudiante_division1_idx` (`division_id_division` ASC) VISIBLE,
  INDEX `fk_estudiante_usuario1_idx` (`usuario_id_User` ASC) VISIBLE,
  INDEX `fk_estudiante_Carrera1_idx` (`Carrera_idCarrera` ASC) VISIBLE,
  CONSTRAINT `fk_estudiante_division1`
    FOREIGN KEY (`division_id_division`)
    REFERENCES `SIGEA`.`division` (`id_division`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_estudiante_usuario1`
    FOREIGN KEY (`usuario_id_User`)
    REFERENCES `SIGEA`.`usuario` (`id_User`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_estudiante_Carrera1`
    FOREIGN KEY (`Carrera_idCarrera`)
    REFERENCES `SIGEA`.`Carrera` (`id_carrera`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`materia`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`materia` (
  `id_Mat` INT NOT NULL AUTO_INCREMENT,
  `Nombre_Mat` VARCHAR(45) NOT NULL,
  `Carrera_id_carrera` INT NOT NULL,
  PRIMARY KEY (`id_Mat`),
  INDEX `fk_materia_Carrera1_idx` (`Carrera_id_carrera` ASC) VISIBLE,
  CONSTRAINT `fk_materia_Carrera1`
    FOREIGN KEY (`Carrera_id_carrera`)
    REFERENCES `SIGEA`.`Carrera` (`id_carrera`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`asesoria`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`asesoria` (
  `id_asesorias` INT NOT NULL AUTO_INCREMENT,
  `Estatus_asesorias` VARCHAR(45) NULL,
  `Fecha_asesorias` DATETIME NULL,
  `materia_id_mat` INT NOT NULL,
  `docente_id_docente` INT NOT NULL,
  `Tema_asesoria` VARCHAR(45) NOT NULL,
  `Comentario_asesoria` VARCHAR(45) NULL,
  PRIMARY KEY (`id_asesorias`),
  INDEX `fk_asesoria_materia_idx` (`materia_id_mat` ASC) VISIBLE,
  INDEX `fk_asesoria_docente1_idx` (`docente_id_docente` ASC) VISIBLE,
  CONSTRAINT `fk_asesoria_materia`
    FOREIGN KEY (`materia_id_mat`)
    REFERENCES `SIGEA`.`materia` (`id_Mat`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_asesoria_docente1`
    FOREIGN KEY (`docente_id_docente`)
    REFERENCES `SIGEA`.`docente` (`id_Docente`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`periodo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`periodo` (
  `id_periodo` INT NOT NULL AUTO_INCREMENT,
  `Nombre_periodo` VARCHAR(45) NULL,
  PRIMARY KEY (`id_periodo`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`grupos`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`grupos` (
  `id_grupo` INT NOT NULL AUTO_INCREMENT,
  `periodo_id_periodo` INT NOT NULL,
  `Nombre_grupo` VARCHAR(45) NULL,
  PRIMARY KEY (`id_grupo`),
  INDEX `fk_grupos_periodo1_idx` (`periodo_id_periodo` ASC) VISIBLE,
  CONSTRAINT `fk_grupos_periodo1`
    FOREIGN KEY (`periodo_id_periodo`)
    REFERENCES `SIGEA`.`periodo` (`id_periodo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

select * from dia;
-- -----------------------------------------------------
-- Table `SIGEA`.`estudianteGrupo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`estudianteGrupo` (
  `id_estudianteGrupo` INT NOT NULL,
  `id_estudiante` INT NOT NULL,
  `grupos_id_grupo` INT NOT NULL,
  PRIMARY KEY (`id_estudianteGrupo`),
  INDEX `fk_estudiante_has_grupo_estudiante1_idx` (`id_estudiante` ASC) VISIBLE,
  INDEX `fk_estudiante_has_grupo_grupos1_idx` (`grupos_id_grupo` ASC) VISIBLE,
  CONSTRAINT `fk_estudiante_has_grupo_estudiante1`
    FOREIGN KEY (`id_estudiante`)
    REFERENCES `SIGEA`.`estudiante` (`id_estudiante`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_estudiante_has_grupo_grupos1`
    FOREIGN KEY (`grupos_id_grupo`)
    REFERENCES `SIGEA`.`grupos` (`id_grupo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`asesoriaEstudiante`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`asesoriaEstudiante` (
  `id_asesoriaEstudinate` INT NOT NULL AUTO_INCREMENT,
  `id_asesoria` INT NOT NULL,
  `idEstudianteGrupo` INT NOT NULL,
  `Asistio_asesoria` TINYBLOB NOT NULL,
  PRIMARY KEY (`id_asesoriaEstudinate`, `id_asesoria`, `idEstudianteGrupo`),
  INDEX `fk_asesoria_has_estudiante_has_grupo_estudiante_has_grupo1_idx` (`idEstudianteGrupo` ASC) VISIBLE,
  INDEX `fk_asesoria_has_estudiante_has_grupo_asesoria1_idx` (`id_asesoria` ASC) VISIBLE,
  CONSTRAINT `fk_asesoria_has_estudiante_has_grupo_asesoria1`
    FOREIGN KEY (`id_asesoria`)
    REFERENCES `SIGEA`.`asesoria` (`id_asesorias`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_asesoria_has_estudiante_has_grupo_estudiante_has_grupo1`
    FOREIGN KEY (`idEstudianteGrupo`)
    REFERENCES `SIGEA`.`estudianteGrupo` (`id_estudianteGrupo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`dia`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`dia` (
  `id_dia` INT NOT NULL,
  `dia_dia` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id_dia`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`HOficial`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`HOficial` (
  `id_HOficial` INT NOT NULL,
  `docente_id_Docente` INT NOT NULL,
  `dia_id_dia` INT NOT NULL,
  `horaInicio` DATETIME NOT NULL,
  `horaFin` DATETIME NOT NULL,
  PRIMARY KEY (`id_HOficial`),
  INDEX `fk_HOficial_docente1_idx` (`docente_id_Docente` ASC) VISIBLE,
  INDEX `fk_HOficial_dia1_idx` (`dia_id_dia` ASC) VISIBLE,
  CONSTRAINT `fk_HOficial_docente1`
    FOREIGN KEY (`docente_id_Docente`)
    REFERENCES `SIGEA`.`docente` (`id_Docente`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_HOficial_dia1`
    FOREIGN KEY (`dia_id_dia`)
    REFERENCES `SIGEA`.`dia` (`id_dia`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`asesoriaHOficial`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`asesoriaHOficial` (
  `id_asesoriaHOficial` INT NOT NULL,
  `asesoria_id_asesorias` INT NOT NULL,
  `HOficial_id_HOficial` INT NOT NULL,
  PRIMARY KEY (`id_asesoriaHOficial`, `asesoria_id_asesorias`, `HOficial_id_HOficial`),
  INDEX `fk_asesoria_has_HOficial_HOficial1_idx` (`HOficial_id_HOficial` ASC) VISIBLE,
  INDEX `fk_asesoria_has_HOficial_asesoria1_idx` (`asesoria_id_asesorias` ASC) VISIBLE,
  CONSTRAINT `fk_asesoria_has_HOficial_asesoria1`
    FOREIGN KEY (`asesoria_id_asesorias`)
    REFERENCES `SIGEA`.`asesoria` (`id_asesorias`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_asesoria_has_HOficial_HOficial1`
    FOREIGN KEY (`HOficial_id_HOficial`)
    REFERENCES `SIGEA`.`HOficial` (`id_HOficial`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `SIGEA`.`asesoriaHNOficial`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `SIGEA`.`asesoriaHNOficial` (
  `id_asesoriaHNOficial` INT NOT NULL,
  `asesoria_id_asesorias` INT NOT NULL,
  `HOficial_id_HOficial` INT NOT NULL,
  PRIMARY KEY (`id_asesoriaHNOficial`, `asesoria_id_asesorias`, `HOficial_id_HOficial`),
  INDEX `fk_asesoria_has_HOficial_HOficial2_idx` (`HOficial_id_HOficial` ASC) VISIBLE,
  INDEX `fk_asesoria_has_HOficial_asesoria2_idx` (`asesoria_id_asesorias` ASC) VISIBLE,
  CONSTRAINT `fk_asesoria_has_HOficial_asesoria2`
    FOREIGN KEY (`asesoria_id_asesorias`)
    REFERENCES `SIGEA`.`asesoria` (`id_asesorias`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_asesoria_has_HOficial_HOficial2`
    FOREIGN KEY (`HOficial_id_HOficial`)
    REFERENCES `SIGEA`.`HOficial` (`id_HOficial`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- insertando datos en tabla rol --
insert into rol (Nombre_rol) values('Docente');
insert into rol (Nombre_rol) values('estudiante');
insert into rol (Nombre_rol) values('Administrador');
select * from rol;
-- corrigiendo nombres de las columnas siguientes-- 
alter table usuario   CHANGE  COLUMN id_usuario  usuario varchar(20);
alter table usuario CHANGE COLUMN id_contrasena contrasena varchar(20);


delete from usuario where rol_id_rol = 2;
select * from usuario;
-- insertando datos en la tabla usuario  para estudiantes--
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti064','ti064',2);
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti025','ti025',2);
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti011','ti011',2);
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti009','ti009',2);
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti004','ti004',2);
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti024','ti024',2);
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti014','ti014',2);
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti054','ti054',2);
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti001','ti001',2);
insert into usuario (usuario, contrasena,rol_id_rol) values ('20173ti002','ti002',2);

select * from rol;
use sigea;
select * from usuario;
-- insertando datos en la tabla usuario para docentes --
insert into usuario (usuario, contrasena,rol_id_rol) values ('bernardohuicochea','dc_huicochea',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('hugoalejandres','dc_alejandres',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('aracelijacobo','dc_jacobo',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('migueldelpilar','dc_delpilar',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('josénarvaez','dc_narvaez',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('reynelflores','dc_flores',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('joséespinoza','dc_espinoza',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('arturovillareal','dc_villareal',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('oscarsalinas','dc_salinas',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('oscarsanchez','dc_sanchez',1);
insert into usuario (usuario, contrasena,rol_id_rol) values ('cernamadero','dc_madero',1);

-- data of admin inserted -- 


insert into usuario (usuario, contrasena,rol_id_rol) values ('jazminrogel','dc_rogel',3);

-- muestra los usuarios y sus roles --
select r.Nombre_rol, us.usuario from usuario us inner join rol r on us.rol_id_rol = r.id_rol;

z